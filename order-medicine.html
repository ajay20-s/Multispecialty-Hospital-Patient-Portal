
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Order Medicine</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        body {
            background: linear-gradient(to right, #f5f7fa, #c3cfe2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container {
            background: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            margin-top: 50px;
        }

        h2 {
            color: #2c3e50;
        }

        .medicine-card {
            border: 1px solid #e1e1e1;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #ffffff;
            transition: 0.3s ease-in-out;
        }

        .medicine-card:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        }

        .search-input {
            border-radius: 30px;
            padding: 10px 20px;
            width: 100%;
            border: 1px solid #ccc;
            margin-bottom: 30px;
        }

        .cart {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            max-width: 300px;
            z-index: 1000;
        }

        .cart h4 {
            margin-bottom: 20px;
        }

        .btn-add {
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2 class="text-center mb-4">Order Medicines</h2>

    <input type="text" class="search-input" id="searchInput" placeholder="Search for medicine..."
           onkeyup="filterMedicines()">

    <div class="row" id="medicineList">
        <!-- Medicine cards generated by JavaScript -->
    </div>
</div>

<div class="cart" id="cart">
    <h4>Your Cart</h4>
    <ul id="cartItems"></ul>
    <p><strong>Total:</strong> ₹<span id="cartTotal">0</span></p>
    <p><strong>Payment Mode:</strong> Cash on Delivery</p>
    <button class="btn btn-success btn-block" id="placeOrderBtn" onclick="placeOrder()">Place Order</button>
</div>

<script>
    // User details from PHP
    const loggedInUser = {
        name: "<?php echo $name; ?>",
        email: "<?php echo $email; ?>"
    };

    const medicines = [
        "Paracetamol 500mg", "Amoxicillin 250mg", "Metformin 500mg", "Atorvastatin 10mg",
        "Omeprazole 20mg", "Ibuprofen 200mg", "Cetirizine 10mg", "Azithromycin 500mg",
        "Diclofenac 50mg", "Pantoprazole 40mg", "Levothyroxine 50mcg", "Losartan 50mg",
        "Amlodipine 5mg", "Clopidogrel 75mg", "Furosemide 40mg", "Ranitidine 150mg",
        "Doxycycline 100mg", "Montelukast 10mg", "Salbutamol 2mg", "Glibenclamide 5mg",
        "Gliclazide 80mg", "Insulin Regular", "Insulin NPH", "Ciprofloxacin 500mg",
        "Hydrochlorothiazide 25mg", "Enalapril 10mg", "Prednisolone 10mg", "Cetirizine + Paracetamol",
        "Amoxicillin + Clavulanic Acid", "Ibuprofen + Paracetamol", "Calcium + Vitamin D3",
        "Vitamin B Complex", "Multivitamin Tablets", "Iron Folic Acid", "Zinc Sulfate 20mg",
        "Chlorpheniramine Maleate", "Diphenhydramine 25mg", "Miconazole Cream",
        "Betadine Ointment", "ORS Sachets", "Electral Powder", "Hydrocortisone Cream",
        "Naproxen 250mg", "Loperamide 2mg", "Ondansetron 4mg", "Domperidone 10mg",
        "Simethicone Drops", "Lactulose Solution", "Rifaximin 200mg", "Nitroglycerin Tablets"
    ];

    let cart = [];

    const medicineList = document.getElementById("medicineList");
    const cartItems = document.getElementById("cartItems");
    const cartTotal = document.getElementById("cartTotal");

    medicines.forEach((med) => {
        const price = Math.floor(Math.random() * 100) + 20;
        const card = document.createElement("div");
        card.className = "col-md-4";
        card.innerHTML = `
            <div class="medicine-card">
                <h5>${med}</h5>
                <p><strong>Price:</strong> ₹${price}</p>
                <button class="btn btn-primary btn-add" onclick="addToCart('${med}', ${price})">Add to Cart</button>
            </div>
        `;
        medicineList.appendChild(card);
    });

    function filterMedicines() {
        const input = document.getElementById('searchInput').value.toLowerCase();
        const cards = document.querySelectorAll('#medicineList .col-md-4');
        cards.forEach(card => {
            card.style.display = card.textContent.toLowerCase().includes(input) ? 'block' : 'none';
        });
    }
    function addToCart(name, price) {
        const existing = cart.find(item => item.name === name);
        if (existing) {
            existing.quantity += 1;
        } else {
            cart.push({ name, price, quantity: 1 });
        }
        renderCart();
    }
    
    function renderCart() {
        cartItems.innerHTML = '';
        let total = 0;
        cart.forEach(item => {
            total += item.price * item.quantity;
            const li = document.createElement('li');
            li.textContent = `${item.name} x ${item.quantity} - ₹${item.price * item.quantity}`;
            cartItems.appendChild(li);
        });
        cartTotal.textContent = total;
    }
    
    function placeOrder() {
        if (cart.length === 0) {
            alert("Your cart is empty!");
            return;
        }
    
        const formData = new FormData();
        cart.forEach((item, index) => {
            formData.append(`items[${index}][name]`, item.name);
            formData.append(`items[${index}][quantity]`, item.quantity);
        });
    
        fetch('place-order.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(response => {
            if (response === 'success') {
                alert("Order placed successfully!");
                cart = [];
                renderCart();
            } else {
                alert("Order failed: " + response);
            }
        })
        .catch(error => {
            console.error("Fetch error:", error);
            alert("Something went wrong!");
        });
    }
    
    
</script>

</body>
</html>
